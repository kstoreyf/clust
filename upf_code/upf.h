int compute_upf(double *x, double *y, double *z, 
                int n_galaxies, double *radii, int n_radii, 
                int n_spheres, double density_threshold, 
                double L, double *results_arr);